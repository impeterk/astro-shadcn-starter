---
import prisma from "@db/prisma";
import BaseLayout from "@/layouts/BaseLayout.astro";
import type { User, Post } from "@db/generated/prisma/client.js";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
type UserWithPosts = User & { posts: Post[] };

const users: UserWithPosts[] = await prisma.user.findMany({
  include: { posts: true },
});
---

<BaseLayout>
  {
    users.map((user) => (
      <Card>
        <CardHeader>
          <CardTitle>{user.name}</CardTitle>
        </CardHeader>
        <CardContent>
          <ul>
            {user.posts.map((post) => (
              <li>{post.title}</li>
            ))}
          </ul>
        </CardContent>
      </Card>
    ))
  }
</BaseLayout>
